# OWASP ZAP Baseline Configuration for POC3
# This configuration defines the security scanning rules for dynamic analysis

# Basic Configuration
zap.baseline.config.version=2.0
zap.baseline.project=POC3-DAST-Scan

# Target Applications
targets:
  - name: "nodejs-react"
    url: "http://localhost:3000"
    context: "POC3-NodeJS-React"
  - name: "python-fastapi"
    url: "http://localhost:8000"
    context: "POC3-Python-FastAPI"
  - name: "java-springboot"
    url: "http://localhost:8080"
    context: "POC3-Java-SpringBoot"
  - name: "dotnet-webapi"
    url: "http://localhost:5000"
    context: "POC3-DotNet-WebAPI"

# Authentication Configuration
auth:
  method: none  # No authentication for hello world apps
  
# Session Management
session:
  management: cookie
  
# Spider Configuration
spider:
  maxDepth: 5
  maxChildren: 10
  delay: 0
  acceptCookies: true
  handleParameters: true
  
# Active Scan Configuration
activeScan:
  enabled: true
  strength: MEDIUM
  alertThreshold: MEDIUM
  maxDuration: 300  # 5 minutes per target
  
# Passive Scan Configuration
passiveScan:
  enabled: true
  
# Policy Configuration
policy:
  rules:
    # Enable important security rules
    - id: "10016"  # Web Browser XSS Protection Not Enabled
      enabled: true
      threshold: MEDIUM
    - id: "10017"  # Cross-Domain JavaScript Source File Inclusion
      enabled: true
      threshold: MEDIUM
    - id: "10021"  # X-Content-Type-Options Header Missing
      enabled: true
      threshold: LOW
    - id: "10023"  # Information Disclosure - Debug Error Messages
      enabled: true
      threshold: LOW
    - id: "10025"  # Information Disclosure - Sensitive Information in URL
      enabled: true
      threshold: MEDIUM
    - id: "10027"  # Information Disclosure - Suspicious Comments
      enabled: true
      threshold: INFO
    - id: "10029"  # Cookie Poisoning
      enabled: true
      threshold: HIGH
    - id: "10032"  # Viewstate Scanner
      enabled: true
      threshold: MEDIUM
    - id: "10035"  # Strict-Transport-Security Header Missing
      enabled: true
      threshold: LOW
    - id: "10036"  # Server Leaks Version Information via "Server" HTTP Response Header Field
      enabled: true
      threshold: LOW
    - id: "10037"  # Server Leaks Information via "X-Powered-By" HTTP Response Header Field(s)
      enabled: true
      threshold: LOW
    - id: "10040"  # Secure Pages Include Mixed Content
      enabled: true
      threshold: MEDIUM
    - id: "10041"  # HTTP to HTTPS Insecure Transition in Form Post
      enabled: true
      threshold: MEDIUM
    - id: "10042"  # HTTPS to HTTP Insecure Transition in Form Post
      enabled: true
      threshold: MEDIUM
    - id: "10043"  # User Controllable JavaScript Event (XSS)
      enabled: true
      threshold: HIGH
    - id: "10044"  # Big Redirect Detected (Potential Sensitive Information Leak)
      enabled: true
      threshold: MEDIUM
    - id: "10045"  # Source Code Disclosure - /WEB-INF folder
      enabled: true
      threshold: HIGH
    - id: "10047"  # HTTPS Content Available via HTTP
      enabled: true
      threshold: HIGH
    - id: "10048"  # Remote Code Execution - Shell Shock
      enabled: true
      threshold: HIGH
    - id: "10049"  # Content Cacheability
      enabled: true
      threshold: INFO
    - id: "10050"  # Retrieved from Cache
      enabled: true
      threshold: INFO
    - id: "10051"  # Relative Path Confusion
      enabled: true
      threshold: MEDIUM
    - id: "10052"  # X-ChromeLogger-Data (XCOLD) Header Information Leak
      enabled: true
      threshold: MEDIUM
    - id: "10054"  # Cookie without SameSite Attribute
      enabled: true
      threshold: LOW
    - id: "10055"  # CSP Scanner
      enabled: true
      threshold: MEDIUM
    - id: "10056"  # X-Debug-Token Information Leak
      enabled: true
      threshold: MEDIUM
    - id: "10057"  # Username Hash Found
      enabled: true
      threshold: INFO
    - id: "10058"  # HTTP Parameter Override
      enabled: true
      threshold: MEDIUM
    - id: "10061"  # X-AspNet-Version Response Header
      enabled: true
      threshold: LOW
    - id: "10062"  # PII Disclosure
      enabled: true
      threshold: HIGH
    - id: "10063"  # Feature Policy Header Not Set
      enabled: true
      threshold: LOW
    - id: "10096"  # Timestamp Disclosure
      enabled: true
      threshold: LOW
    - id: "10097"  # Hash Disclosure
      enabled: true
      threshold: INFO
    - id: "10098"  # Cross-Domain Misconfiguration
      enabled: true
      threshold: MEDIUM
    - id: "10099"  # Source Code Disclosure
      enabled: true
      threshold: HIGH
    - id: "10101"  # Sensitive Information Disclosure
      enabled: true
      threshold: HIGH
    - id: "10102"  # Information Disclosure - Database Error Messages
      enabled: true
      threshold: MEDIUM
    - id: "10103"  # Possible Username Enumeration
      enabled: true
      threshold: INFO
    - id: "10104"  # User Agent Fuzzer
      enabled: true
      threshold: INFO
    - id: "10105"  # Weak Authentication Method
      enabled: true
      threshold: MEDIUM
    - id: "10106"  # HTTP Only Site
      enabled: true
      threshold: MEDIUM
    - id: "10107"  # Httpoxy - Proxy Header Misuse
      enabled: true
      threshold: MEDIUM
    - id: "10108"  # Reverse Tabnabbing
      enabled: true
      threshold: MEDIUM
    - id: "10109"  # Modern Web Application
      enabled: true
      threshold: INFO
    - id: "10110"  # Dangerous JS Functions
      enabled: true
      threshold: LOW
    - id: "10111"  # Authentication Credentials Captured
      enabled: true
      threshold: HIGH

# Report Configuration
reporting:
  format: 
    - JSON
    - HTML
    - XML
  outputDir: "/zap/wrk/reports"
  filename: "zap-baseline-report"
  
# Advanced Options
advanced:
  maxAlerts: 1000
  timeout: 600  # 10 minutes total timeout
  followRedirects: true
  handleAntiCSRF: true
  
# Exclusions
exclusions:
  # Exclude static assets
  - ".*\\.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$"
  # Exclude health check endpoints from certain scans
  - ".*/health$"
  # Exclude documentation endpoints
  - ".*/docs$"
  - ".*/swagger.*$"
  - ".*/redoc$"